<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»Šæ—¥ãªã«ã™ã‚‹ï¼Ÿ - é‹å‘½ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£</title>
    <!-- LIFF SDK -->
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700;900&family=Playfair+Display:wght@400;500;600;700;900&family=Cormorant+Garamond:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --neon-pink: #FF006E;
            --neon-blue: #00F5FF;
            --neon-purple: #8B00FF;
            --neon-gold: #FFD700;
            --neon-orange: #FF4500;
            --deep-black: #0a0015;
        }

        body {
            font-family: 'Cormorant Garamond', serif;
            background: #0a0015;
            min-height: 100vh;
            overflow-x: hidden;
            position: fixed;
            width: 100%;
            color: #fff;
            /* ã‚¹ãƒãƒ›æœ€é©åŒ– */
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: none;
        }

        /* æ¿€ã—ãå‹•ãèƒŒæ™¯ãƒ¬ã‚¤ãƒ¤ãƒ¼ - ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ– */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(255, 0, 110, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(0, 245, 255, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(139, 0, 255, 0.2) 0%, transparent 50%);
            animation: backgroundShift 8s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
            will-change: transform;
            transform: translateZ(0);
        }

        /* è™¹è‰²ã®ã‚ªãƒ¼ãƒ© - ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ– */
        body::after {
            content: '';
            position: fixed;
            top: 50%;
            left: 50%;
            width: 600px;
            height: 600px;
            background: conic-gradient(
                from 0deg,
                #FF006E 0deg,
                #FF4500 60deg,
                #FFD700 120deg,
                #00F5FF 180deg,
                #8B00FF 240deg,
                #FF006E 300deg,
                #FF006E 360deg
            );
            opacity: 0.2;
            animation: rainbowSpin 10s linear infinite, pulsate 3s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
            filter: blur(100px);
            transform: translate(-50%, -50%);
            will-change: transform, opacity;
        }

        @keyframes backgroundShift {
            0%, 100% { 
                transform: translateZ(0) scale(1) rotate(0deg);
                opacity: 1;
            }
            50% { 
                transform: translateZ(0) scale(1.2) rotate(90deg);
                opacity: 0.7;
            }
        }

        @keyframes rainbowSpin {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }

        @keyframes pulsate {
            0%, 100% { 
                opacity: 0.2;
                transform: translate(-50%, -50%) scale(1);
            }
            50% { 
                opacity: 0.3;
                transform: translate(-50%, -50%) scale(1.1);
            }
        }

        /* æ˜Ÿç©ºãƒ¬ã‚¤ãƒ¤ãƒ¼ */
        .star-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 5px white;
            animation: starTwinkle 3s ease-in-out infinite;
            will-change: opacity;
        }

        @keyframes starTwinkle {
            0%, 100% { 
                opacity: 0.3;
            }
            50% { 
                opacity: 1;
            }
        }

        /* æµã‚Œæ˜Ÿã‚¨ãƒ•ã‚§ã‚¯ãƒˆ - ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ– */
        .shooting-star {
            position: fixed;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 10px 2px white;
            animation: shoot 2s linear;
            pointer-events: none;
            z-index: 0;
            will-change: transform, opacity;
        }

        @keyframes shoot {
            0% {
                transform: translate3d(0, 0, 0);
                opacity: 1;
            }
            100% {
                transform: translate3d(300px, 300px, 0);
                opacity: 0;
            }
        }

        /* ãƒã‚ªãƒ³ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ« - ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ– */
        .neon-particle {
            position: fixed;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 5;
            animation: float-neon 4s ease-out;
            will-change: transform, opacity;
        }

        @keyframes float-neon {
            0% {
                transform: translate3d(0, 0, 0) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translate3d(0, -100vh, 0) scale(1.5);
                opacity: 0;
            }
        }

        .container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1;
            max-width: 450px;
            margin: 0 auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior-y: contain;
        }

        header {
            text-align: center;
            padding: 40px 0 20px;
            animation: explosiveEntrance 1s ease-out;
            position: relative;
        }

        @keyframes explosiveEntrance {
            0% {
                opacity: 0;
                transform: translate3d(0, -20px, 0) scale(0.8);
            }
            100% {
                opacity: 1;
                transform: translate3d(0, 0, 0) scale(1);
            }
        }

        header::before,
        header::after {
            content: 'âœ¦';
            position: absolute;
            font-size: 2rem;
            animation: orbitSpin 4s linear infinite;
            filter: drop-shadow(0 0 10px #FF006E);
            will-change: transform;
        }

        header::before {
            top: 0;
            left: 10%;
            color: var(--neon-pink);
            animation-delay: 0s;
        }

        header::after {
            top: 0;
            right: 10%;
            color: var(--neon-blue);
            animation-delay: 2s;
        }

        @keyframes orbitSpin {
            0% { 
                transform: rotate(0deg);
                opacity: 0.6;
            }
            50% {
                opacity: 1;
            }
            100% { 
                transform: rotate(360deg);
                opacity: 0.6;
            }
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(2rem, 8vw, 3rem);
            font-weight: 900;
            margin-bottom: 15px;
            background: linear-gradient(
                45deg,
                var(--neon-pink) 0%,
                var(--neon-orange) 25%,
                var(--neon-gold) 50%,
                var(--neon-blue) 75%,
                var(--neon-purple) 100%
            );
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: rainbowShift 3s ease-in-out infinite;
            letter-spacing: 6px;
            text-transform: uppercase;
            filter: drop-shadow(0 0 20px rgba(255, 0, 110, 0.8))
                    drop-shadow(0 0 40px rgba(0, 245, 255, 0.6));
            position: relative;
        }

        @keyframes rainbowShift {
            0%, 100% {
                background-position: 0% 50%;
                transform: scale(1);
            }
            50% {
                background-position: 100% 50%;
                transform: scale(1.05);
            }
        }

        .subtitle {
            font-family: 'Cinzel', serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--neon-gold);
            letter-spacing: 4px;
            text-transform: uppercase;
            animation: glowPulse 2s ease-in-out infinite;
            text-shadow: 
                0 0 10px var(--neon-gold),
                0 0 20px var(--neon-orange),
                0 0 30px var(--neon-pink);
        }

        @keyframes glowPulse {
            0%, 100% {
                text-shadow: 
                    0 0 10px var(--neon-gold),
                    0 0 20px var(--neon-orange);
                opacity: 0.8;
            }
            50% {
                text-shadow: 
                    0 0 20px var(--neon-gold),
                    0 0 40px var(--neon-orange),
                    0 0 60px var(--neon-pink);
                opacity: 1;
            }
        }

        /* ã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒ†ãƒŠ - ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ– */
        .main-card-container {
            perspective: 2000px;
            margin-bottom: 30px;
            animation: cardDrop 1s ease-out 0.3s both;
        }

        @keyframes cardDrop {
            0% {
                opacity: 0;
                transform: translate3d(0, -50px, 0) scale(0.8);
            }
            100% {
                opacity: 1;
                transform: translate3d(0, 0, 0) scale(1);
            }
        }

        /* 3Dãƒ•ãƒªãƒƒãƒ—ã‚«ãƒ¼ãƒ‰æœ¬ä½“ - ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ– */
        .main-card {
            position: relative;
            width: 100%;
            min-height: 550px;
            transform-style: preserve-3d;
            transition: transform 1s ease-out;
            will-change: transform;
        }

        .main-card.flipped {
            transform: rotateY(180deg);
        }

        /* ã‚«ãƒ¼ãƒ‰é¢å…±é€šè¨­å®š */
        .card-face {
            position: absolute;
            width: 100%;
            min-height: 550px;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            border-radius: 25px;
            padding: 35px 30px;
        }

        /* è¡¨é¢ */
        .card-front {
            background: linear-gradient(135deg, 
                rgba(26, 0, 51, 0.95) 0%, 
                rgba(45, 0, 82, 0.95) 50%,
                rgba(26, 0, 51, 0.95) 100%);
            box-shadow: 
                inset 0 0 80px rgba(255, 0, 110, 0.2),
                0 30px 100px rgba(0, 0, 0, 0.9),
                0 0 60px rgba(0, 245, 255, 0.4);
        }

        /* ãƒ›ãƒ­ã‚°ãƒ©ãƒ  - è¡¨é¢ã®ã¿ */
        .card-front::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                45deg,
                transparent 30%,
                rgba(255, 0, 110, 0.4) 40%,
                rgba(0, 245, 255, 0.4) 50%,
                rgba(139, 0, 255, 0.4) 60%,
                transparent 70%
            );
            animation: hologram 3s linear infinite;
            pointer-events: none;
            z-index: 0;
            border-radius: 25px;
        }

        @keyframes hologram {
            0% {
                transform: translate(-50%, -50%) rotate(0deg);
            }
            100% {
                transform: translate(-50%, -50%) rotate(360deg);
            }
        }

        /* è™¹è‰²æ  - è¡¨é¢ */
        .card-front::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 4px solid transparent;
            border-radius: 25px;
            background: linear-gradient(45deg, 
                var(--neon-pink), 
                var(--neon-orange),
                var(--neon-gold), 
                var(--neon-blue), 
                var(--neon-purple),
                var(--neon-pink)
            ) border-box;
            background-size: 300% 300%;
            -webkit-mask: 
                linear-gradient(#fff 0 0) padding-box, 
                linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            animation: borderRainbow 4s linear infinite;
            pointer-events: none;
            z-index: 0;
            box-shadow: 
                inset 0 0 40px rgba(255, 0, 110, 0.3),
                0 0 40px rgba(0, 245, 255, 0.5),
                0 0 80px rgba(139, 0, 255, 0.3);
        }

        @keyframes borderRainbow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* è¡¨é¢ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
        .card-front > * {
            position: relative;
            z-index: 1;
        }

        /* è£é¢ */
        .card-back {
            background: linear-gradient(135deg, 
                rgba(26, 0, 51, 0.98) 0%, 
                rgba(45, 0, 82, 0.98) 50%,
                rgba(26, 0, 51, 0.98) 100%);
            transform: rotateY(180deg);
            box-shadow: 
                inset 0 0 80px rgba(139, 0, 255, 0.3),
                0 30px 100px rgba(0, 0, 0, 0.9),
                0 0 60px rgba(255, 215, 0, 0.5);
            display: flex;
            flex-direction: column;
        }

        /* è™¹è‰²æ  - è£é¢ */
        .card-back::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 4px solid transparent;
            border-radius: 25px;
            background: linear-gradient(45deg, 
                var(--neon-pink), 
                var(--neon-orange),
                var(--neon-gold), 
                var(--neon-blue), 
                var(--neon-purple),
                var(--neon-pink)
            ) border-box;
            background-size: 300% 300%;
            -webkit-mask: 
                linear-gradient(#fff 0 0) padding-box, 
                linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            animation: borderRainbow 4s linear infinite;
            pointer-events: none;
            z-index: 0;
            box-shadow: 
                inset 0 0 40px rgba(255, 215, 0, 0.3),
                0 0 40px rgba(255, 215, 0, 0.5),
                0 0 80px rgba(139, 0, 255, 0.3);
        }

        /* è£é¢ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
        .card-back > * {
            position: relative;
            z-index: 1;
        }

        /* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚°ãƒ«ãƒ¼ãƒ— */
        .filter-group {
            margin-bottom: 22px;
            position: relative;
            animation: filterSlideIn 0.6s ease-out backwards;
            z-index: 2;
        }

        .filter-group:nth-child(1) { animation-delay: 0.1s; }
        .filter-group:nth-child(2) { animation-delay: 0.2s; }
        .filter-group:nth-child(3) { animation-delay: 0.3s; }
        .filter-group:nth-child(4) { animation-delay: 0.4s; }

        @keyframes filterSlideIn {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .filter-label {
            display: block;
            font-family: 'Orbitron', sans-serif;
            font-size: 0.9rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--neon-pink), var(--neon-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            padding-left: 5px;
            text-transform: uppercase;
            letter-spacing: 3px;
            animation: labelPulse 3s ease-in-out infinite;
        }

        @keyframes labelPulse {
            0%, 100% {
                filter: brightness(1);
            }
            50% {
                filter: brightness(1.5) drop-shadow(0 0 10px var(--neon-pink));
            }
        }

        select {
            width: 100%;
            padding: 16px 50px 16px 20px;
            border: 3px solid transparent;
            border-radius: 15px;
            font-size: 1.05rem;
            font-family: 'Cormorant Garamond', serif;
            font-weight: 600;
            color: var(--neon-gold);
            background: rgba(26, 0, 51, 0.8);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23FF006E' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 24px;
            box-shadow: 
                inset 0 0 20px rgba(0, 0, 0, 0.6),
                0 0 20px rgba(255, 0, 110, 0.3),
                0 5px 15px rgba(0, 0, 0, 0.5);
        }

        select:focus {
            outline: none;
            border-color: var(--neon-pink);
            transform: translateY(-3px) scale(1.02);
            box-shadow: 
                inset 0 0 30px rgba(255, 0, 110, 0.3),
                0 0 40px rgba(255, 0, 110, 0.8),
                0 0 60px rgba(0, 245, 255, 0.6),
                0 10px 30px rgba(0, 0, 0, 0.6);
            animation: selectGlow 1.5s ease-in-out infinite;
        }

        @keyframes selectGlow {
            0%, 100% {
                box-shadow: 
                    inset 0 0 30px rgba(255, 0, 110, 0.3),
                    0 0 40px rgba(255, 0, 110, 0.8),
                    0 10px 30px rgba(0, 0, 0, 0.6);
            }
            50% {
                box-shadow: 
                    inset 0 0 40px rgba(0, 245, 255, 0.4),
                    0 0 60px rgba(0, 245, 255, 0.9),
                    0 0 80px rgba(139, 0, 255, 0.6),
                    0 10px 30px rgba(0, 0, 0, 0.6);
            }
        }

        select:hover {
            border-color: var(--neon-blue);
            transform: translateY(-2px);
            box-shadow: 
                inset 0 0 25px rgba(0, 245, 255, 0.2),
                0 0 30px rgba(0, 245, 255, 0.6),
                0 8px 20px rgba(0, 0, 0, 0.5);
        }

        select option {
            background: #1a0033;
            color: #fff;
            font-family: 'Cormorant Garamond', serif;
            padding: 10px;
        }

        /* æ±ºã‚ã‚‹ãƒœã‚¿ãƒ³ - ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ– */
        .decide-button {
            width: 100%;
            padding: 22px;
            border: none;
            border-radius: 18px;
            background: linear-gradient(135deg, 
                var(--neon-pink) 0%, 
                var(--neon-orange) 25%,
                var(--neon-gold) 50%,
                var(--neon-blue) 75%,
                var(--neon-purple) 100%);
            background-size: 300% 300%;
            color: #fff;
            font-size: 1.6rem;
            font-weight: 900;
            font-family: 'Orbitron', sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 5px;
            position: relative;
            overflow: hidden;
            text-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
            animation: buttonRainbow 3s ease-in-out infinite;
            box-shadow: 
                inset 0 0 30px rgba(255, 255, 255, 0.3),
                0 0 40px rgba(255, 0, 110, 0.6),
                0 10px 30px rgba(0, 0, 0, 0.8);
            z-index: 2;
            will-change: transform;
            -webkit-tap-highlight-color: transparent;
        }

        @keyframes buttonRainbow {
            0%, 100% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
        }

        .decide-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: radial-gradient(circle, 
                rgba(255, 255, 255, 0.8) 0%, 
                transparent 70%);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .decide-button:active {
            transform: scale(0.95);
        }

        .decide-button:active::before {
            width: 300px;
            height: 300px;
        }

        .decide-button:disabled {
            background: rgba(50, 50, 50, 0.8);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            opacity: 0.6;
            animation: none;
        }

        /* çµæœè¡¨ç¤º */
        .result-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 25px;
            border-bottom: 3px solid transparent;
            border-image: linear-gradient(90deg, 
                transparent,
                var(--neon-pink),
                var(--neon-blue),
                var(--neon-purple),
                transparent) 1;
            position: relative;
            animation: headerEntrance 1s ease-out;
        }

        @keyframes headerEntrance {
            0% {
                opacity: 0;
                transform: scale(0.5) rotateX(90deg);
            }
            50% {
                transform: scale(1.1) rotateX(-5deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotateX(0deg);
            }
        }

        .result-header::before {
            content: '';
            position: absolute;
            top: -30px;
            left: 50%;
            width: 2px;
            height: 60px;
            background: linear-gradient(to bottom, 
                transparent,
                var(--neon-gold),
                transparent);
            box-shadow: 0 0 20px var(--neon-gold), 0 0 40px var(--neon-orange);
            animation: lightBeam 2s ease-in-out infinite;
            transform: translateX(-50%);
        }

        @keyframes lightBeam {
            0%, 100% {
                opacity: 0.3;
                height: 40px;
            }
            50% {
                opacity: 1;
                height: 80px;
            }
        }

        .result-header::after {
            content: 'â˜…';
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2rem;
            color: var(--neon-gold);
            animation: starBurst 1.5s ease-out infinite;
            filter: drop-shadow(0 0 20px var(--neon-gold));
        }

        @keyframes starBurst {
            0% {
                opacity: 0;
                transform: translateX(-50%) scale(0) rotate(0deg);
            }
            50% {
                opacity: 1;
            }
            100% {
                opacity: 0;
                transform: translateX(-50%) scale(2) rotate(180deg);
            }
        }

        .result-title {
            font-family: 'Cinzel', serif;
            font-size: 2rem;
            font-weight: 900;
            background: linear-gradient(135deg, 
                var(--neon-pink),
                var(--neon-orange),
                var(--neon-gold),
                var(--neon-blue));
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: titleShine 3s ease-in-out infinite;
            margin-bottom: 15px;
            letter-spacing: 3px;
            filter: drop-shadow(0 0 20px rgba(255, 0, 110, 0.8))
                    drop-shadow(0 0 40px rgba(0, 245, 255, 0.6));
        }

        @keyframes titleShine {
            0%, 100% {
                background-position: 0% 50%;
                transform: scale(1);
            }
            50% {
                background-position: 100% 50%;
                transform: scale(1.05);
            }
        }

        .result-location {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            color: var(--neon-blue);
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            letter-spacing: 3px;
            text-transform: uppercase;
            text-shadow: 
                0 0 10px var(--neon-blue),
                0 0 20px var(--neon-purple);
            animation: locationPulse 2s ease-in-out infinite;
        }

        @keyframes locationPulse {
            0%, 100% {
                text-shadow: 
                    0 0 10px var(--neon-blue),
                    0 0 20px var(--neon-purple);
            }
            50% {
                text-shadow: 
                    0 0 20px var(--neon-blue),
                    0 0 40px var(--neon-purple),
                    0 0 60px var(--neon-pink);
            }
        }

        .result-body {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .result-section {
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(26, 0, 51, 0.6);
            border-radius: 15px;
            border: 2px solid transparent;
            background-clip: padding-box;
            position: relative;
            animation: sectionFadeIn 0.8s ease-out backwards;
        }

        .result-section:nth-child(1) { animation-delay: 0.3s; }
        .result-section:nth-child(2) { animation-delay: 0.5s; }

        @keyframes sectionFadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 15px;
            padding: 2px;
            background: linear-gradient(45deg, 
                var(--neon-pink),
                var(--neon-blue),
                var(--neon-purple),
                var(--neon-pink));
            background-size: 300% 300%;
            -webkit-mask: 
                linear-gradient(#fff 0 0) content-box, 
                linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            animation: borderFlow 3s linear infinite;
            pointer-events: none;
        }

        @keyframes borderFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .result-section-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.85rem;
            font-weight: 900;
            color: var(--neon-pink);
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-bottom: 12px;
            text-shadow: 0 0 15px var(--neon-pink);
        }

        .result-section-content {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.15rem;
            color: #fff;
            font-weight: 600;
            line-height: 1.7;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
        }

        .result-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 25px;
            animation: tagsFadeIn 1s ease-out 0.7s backwards;
        }

        @keyframes tagsFadeIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .tag {
            background: linear-gradient(135deg, 
                rgba(255, 0, 110, 0.4),
                rgba(0, 245, 255, 0.4));
            border: 2px solid var(--neon-blue);
            color: #fff;
            padding: 10px 18px;
            border-radius: 25px;
            font-family: 'Orbitron', sans-serif;
            font-size: 0.8rem;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            text-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
            box-shadow: 
                inset 0 0 20px rgba(255, 255, 255, 0.2),
                0 0 20px rgba(0, 245, 255, 0.4),
                0 4px 15px rgba(0, 0, 0, 0.6);
            animation: tagFloat 3s ease-in-out infinite;
        }

        .tag:nth-child(1) { animation-delay: 0s; }
        .tag:nth-child(2) { animation-delay: 0.3s; }
        .tag:nth-child(3) { animation-delay: 0.6s; }

        @keyframes tagFloat {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-5px);
            }
        }

        /* LINEãƒ¦ãƒ¼ã‚¶ãƒ¼åè¡¨ç¤º */
        .user-greeting {
            text-align: center;
            margin-bottom: 10px;
            font-family: 'Orbitron', sans-serif;
            font-size: 0.9rem;
            color: var(--neon-gold);
            text-shadow: 0 0 10px var(--neon-gold);
            animation: glowPulse 2s ease-in-out infinite;
        }

        /* ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³ */
        .share-button {
            width: 100%;
            padding: 16px;
            border: 3px solid var(--neon-pink);
            border-radius: 15px;
            background: linear-gradient(135deg, 
                rgba(255, 0, 110, 0.3),
                rgba(255, 69, 0, 0.3));
            color: var(--neon-pink);
            font-size: 1.1rem;
            font-weight: 700;
            font-family: 'Orbitron', sans-serif;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            margin-top: 15px;
            letter-spacing: 3px;
            text-transform: uppercase;
            box-shadow: 
                inset 0 0 30px rgba(0, 0, 0, 0.6),
                0 0 20px rgba(255, 0, 110, 0.4),
                0 6px 20px rgba(0, 0, 0, 0.6);
            text-shadow: 0 0 15px var(--neon-pink);
        }

        .share-button:hover {
            background: linear-gradient(135deg, 
                rgba(255, 0, 110, 0.6),
                rgba(255, 69, 0, 0.6));
            border-color: var(--neon-orange);
            transform: translateY(-4px) scale(1.02);
            box-shadow: 
                inset 0 0 40px rgba(255, 255, 255, 0.3),
                0 0 40px var(--neon-pink),
                0 0 60px var(--neon-orange),
                0 10px 30px rgba(0, 0, 0, 0.8);
        }

        /* é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ */
        .close-button {
            position: fixed;
            top: 15px;
            right: 15px;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: 2px solid var(--neon-blue);
            background: rgba(26, 0, 51, 0.9);
            color: var(--neon-blue);
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 0 20px rgba(0, 245, 255, 0.5),
                0 4px 15px rgba(0, 0, 0, 0.6);
            text-shadow: 0 0 10px var(--neon-blue);
        }

        .close-button:hover {
            background: rgba(0, 245, 255, 0.2);
            transform: scale(1.1) rotate(90deg);
            box-shadow: 
                0 0 30px rgba(0, 245, 255, 0.8),
                0 6px 20px rgba(0, 0, 0, 0.8);
        }

        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º */
        .liff-loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0a0015;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .liff-loading.hidden {
            display: none;
        }

        .liff-loading-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            color: var(--neon-blue);
            margin-top: 20px;
            text-shadow: 0 0 20px var(--neon-blue);
            animation: glowPulse 2s ease-in-out infinite;
        }

        .reset-button {
            width: 100%;
            padding: 16px;
            border: 3px solid var(--neon-purple);
            border-radius: 15px;
            background: rgba(26, 0, 51, 0.8);
            color: var(--neon-blue);
            font-size: 1.1rem;
            font-weight: 700;
            font-family: 'Orbitron', sans-serif;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            margin-top: 25px;
            letter-spacing: 3px;
            text-transform: uppercase;
            box-shadow: 
                inset 0 0 30px rgba(0, 0, 0, 0.6),
                0 0 20px rgba(139, 0, 255, 0.4),
                0 6px 20px rgba(0, 0, 0, 0.6);
            text-shadow: 0 0 15px var(--neon-blue);
        }

        .reset-button:hover {
            background: linear-gradient(135deg, 
                rgba(139, 0, 255, 0.6),
                rgba(0, 245, 255, 0.6));
            border-color: var(--neon-blue);
            transform: translateY(-4px) scale(1.02);
            box-shadow: 
                inset 0 0 40px rgba(255, 255, 255, 0.3),
                0 0 40px var(--neon-blue),
                0 0 60px var(--neon-purple),
                0 10px 30px rgba(0, 0, 0, 0.8);
        }

        @media (max-width: 380px) {
            h1 {
                font-size: 1.8rem;
                letter-spacing: 3px;
            }
            .card-face {
                padding: 25px;
            }
            .decide-button {
                font-size: 1.3rem;
                letter-spacing: 3px;
            }
        }

        /* è¿½åŠ ã®ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ– */
        @media (max-width: 480px) {
            body::after {
                width: 400px;
                height: 400px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .subtitle {
                font-size: 0.9rem;
            }
            
            header::before,
            header::after {
                font-size: 1.5rem;
            }
            
            .card-face {
                min-height: 500px;
                padding: 30px 25px;
            }
            
            .main-card {
                min-height: 500px;
            }
            
            .filter-label {
                font-size: 0.85rem;
            }
            
            select {
                font-size: 1rem;
                padding: 14px 45px 14px 18px;
            }
            
            .decide-button {
                font-size: 1.4rem;
                padding: 18px;
            }
            
            .result-title {
                font-size: 1.7rem;
            }
            
            .result-location {
                font-size: 1rem;
            }
            
            .result-section {
                padding: 18px;
            }
            
            .result-section-content {
                font-size: 1.05rem;
            }
            
            .tag {
                font-size: 0.75rem;
                padding: 8px 15px;
            }
        }

        /* æ¨ªç”»é¢å¯¾å¿œ */
        @media (max-height: 700px) and (orientation: landscape) {
            .container {
                padding: 15px;
            }
            
            header {
                padding: 20px 0 10px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .subtitle {
                font-size: 0.85rem;
            }
            
            .card-face {
                padding: 20px;
                min-height: auto;
            }
            
            .filter-group {
                margin-bottom: 15px;
            }
            
            .decide-button {
                padding: 15px;
                margin-top: 15px;
            }
        }

        .loading {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 5px solid transparent;
            border-top-color: var(--neon-pink);
            border-right-color: var(--neon-blue);
            border-bottom-color: var(--neon-purple);
            border-left-color: var(--neon-gold);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            box-shadow: 0 0 30px rgba(255, 0, 110, 0.6);
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ã‚«ãƒ¼ãƒ‰ãƒ‰ãƒ­ãƒ¼æ¼”å‡º - ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ– */
        .main-card.drawing {
            animation: explosiveDraw 1s ease-out;
        }

        @keyframes explosiveDraw {
            0% {
                transform: scale(1) rotateY(0deg);
            }
            50% {
                transform: scale(1.1) rotateY(90deg);
                filter: brightness(1.5);
            }
            100% {
                transform: scale(1) rotateY(180deg);
            }
        }

        /* ã‚«ãƒ¼ãƒ‰ãŒã‚ãã‚ŒãŸå¾Œã®æ¼”å‡º - ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ– */
        .main-card.flipped {
            animation: victoryPulse 1.5s ease-out;
        }

        @keyframes victoryPulse {
            0%, 100% {
                transform: rotateY(180deg) scale(1);
            }
            50% {
                transform: rotateY(180deg) scale(1.02);
                filter: brightness(1.2);
            }
        }
    </style>
</head>
<body>
    <!-- LIFFãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ -->
    <div class="liff-loading" id="liff-loading">
        <div class="loading"></div>
        <div class="liff-loading-text">LINEé€£æºä¸­...</div>
    </div>

    <!-- é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ -->
    <button class="close-button" id="close-btn" style="display: none;">âœ•</button>

    <div class="container">
        <header>
            <div class="user-greeting" id="user-greeting" style="display: none;"></div>
            <h1 data-text="ä»Šæ—¥ãªã«ã™ã‚‹ï¼Ÿ">ä»Šæ—¥ãªã«ã™ã‚‹ï¼Ÿ</h1>
            <p class="subtitle">ã‚ãªãŸã®é‹å‘½ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’è¦‹ã¤ã‘ã‚ˆã†</p>
        </header>

        <div class="star-layer" id="star-layer"></div>

        <div class="main-card-container">
            <div class="main-card" id="main-card">
                <!-- è¡¨é¢ -->
                <div class="card-face card-front">
                    <div class="filter-group">
                        <label class="filter-label">ğŸ• æ™‚é–“ã¯ã©ã®ãã‚‰ã„ï¼Ÿ</label>
                        <select id="time-filter">
                            <option value="">æŒ‡å®šã—ãªã„</option>
                            <option value="30åˆ†ä»¥å†…">30åˆ†ä»¥å†…</option>
                            <option value="1æ™‚é–“">1æ™‚é–“</option>
                            <option value="2æ™‚é–“">2æ™‚é–“</option>
                            <option value="3æ™‚é–“">3æ™‚é–“</option>
                            <option value="åŠæ—¥">åŠæ—¥</option>
                            <option value="1æ—¥">1æ—¥</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">ğŸ‘¥ äººæ•°ã¯ï¼Ÿ</label>
                        <select id="people-filter">
                            <option value="">æŒ‡å®šã—ãªã„</option>
                            <option value="1äºº">1äºº</option>
                            <option value="2äºº">2äºº</option>
                            <option value="3-4äºº">3-4äºº</option>
                            <option value="5äººä»¥ä¸Š">5äººä»¥ä¸Š</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">ğŸ“ ã©ã“ã«è¡Œãï¼Ÿ</label>
                        <select id="location-filter">
                            <option value="">æŒ‡å®šã—ãªã„</option>
                            <option value="æ±äº¬">æ±äº¬</option>
                            <option value="ç¥å¥ˆå·">ç¥å¥ˆå·</option>
                            <option value="åŸ¼ç‰">åŸ¼ç‰</option>
                            <option value="åƒè‘‰">åƒè‘‰</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">ğŸŒ¸ å­£ç¯€ã¯ï¼Ÿ</label>
                        <select id="season-filter">
                            <option value="">æŒ‡å®šã—ãªã„</option>
                            <option value="æ˜¥">æ˜¥</option>
                            <option value="å¤">å¤</option>
                            <option value="ç§‹">ç§‹</option>
                            <option value="å†¬">å†¬</option>
                            <option value="é€šå¹´">é€šå¹´</option>
                        </select>
                    </div>

                    <button class="decide-button" id="decide-btn" style="margin-top: 30px;">
                        æ±ºã‚ã‚‹ï¼
                    </button>
                </div>

                <!-- è£é¢ -->
                <div class="card-face card-back">
                    <div class="result-header">
                        <h2 class="result-title" id="result-title">å ´æ‰€å</h2>
                        <p class="result-location" id="result-location">ğŸ“ ã‚¨ãƒªã‚¢</p>
                    </div>
                    <div class="result-body">
                        <div class="result-section">
                            <h3 class="result-section-title">ã§ãã‚‹ã“ã¨</h3>
                            <p class="result-section-content" id="result-activity">ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã®èª¬æ˜</p>
                        </div>
                        <div class="result-section">
                            <h3 class="result-section-title">ãŠã™ã™ã‚ãƒã‚¤ãƒ³ãƒˆ</h3>
                            <p class="result-section-content" id="result-point">ãƒã‚¤ãƒ³ãƒˆã®èª¬æ˜</p>
                        </div>
                        <div class="result-tags" id="result-tags">
                            <span class="tag">â±ï¸ æ™‚é–“</span>
                            <span class="tag">ğŸ‘¥ äººæ•°</span>
                            <span class="tag">ğŸŒ¸ å­£ç¯€</span>
                        </div>
                    </div>
                    <button class="share-button" id="share-btn" style="display: none;">LINEã§ã‚·ã‚§ã‚¢ ğŸ“¤</button>
                    <button class="reset-button" id="reset-btn">ã‚‚ã†ä¸€åº¦å¼•ã</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========================================
        // LIFFè¨­å®š
        // ========================================
        const LIFF_ID = '2008621315-WjyqJ7mQ'; // LINE Mini Appç”¨LIFF ID

        // ========================================
        // ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆ200ä»¶ï¼‰
        // ========================================
        const activities = [
            // æ±äº¬ - è¦³å…‰ã‚¹ãƒãƒƒãƒˆ
            { location: "æ±äº¬", place: "æµ…è‰å¯º", activity: "é›·é–€ã§å†™çœŸæ’®å½±ï¼†ä»²è¦‹ä¸–é€šã‚Šé£Ÿã¹æ­©ã", time: "2æ™‚é–“", point: "äººå½¢ç„¼ãã¨é›·ãŠã“ã—ã¯å¤–ã›ãªã„ï¼", season: "é€šå¹´", people: "1äºº" },
            { location: "æ±äº¬", place: "æ±äº¬ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼", activity: "å±•æœ›ãƒ‡ãƒƒã‚­ã‹ã‚‰æ±äº¬ä¸€æœ›", time: "2æ™‚é–“", point: "å¤•æš®ã‚Œæ™‚ãŒãƒ­ãƒãƒ³ãƒãƒƒã‚¯", season: "é€šå¹´", people: "2äºº" },
            { location: "æ±äº¬", place: "ä¸Šé‡å‹•ç‰©åœ’", activity: "ãƒ‘ãƒ³ãƒ€è¦³å¯Ÿï¼†åœ’å†…æ•£ç­–", time: "3æ™‚é–“", point: "ã‚·ãƒ£ãƒ³ã‚·ãƒ£ãƒ³ã®å­ä¾›ãŸã¡ã«ä¼šãˆã‚‹", season: "é€šå¹´", people: "3-4äºº" },
            { location: "æ±äº¬", place: "ç¯‰åœ°å ´å¤–å¸‚å ´", activity: "æµ·é®®ä¸¼ã¨ãŠå¯¿å¸ã®é£Ÿã¹æ­©ã", time: "2æ™‚é–“", point: "æœæ—©ã‚ã«è¡Œãã®ãŒæ­£è§£", season: "é€šå¹´", people: "2äºº" },
            { location: "æ±äº¬", place: "æ˜æ²»ç¥å®®", activity: "å¾¡æœ±å°å·¡ã‚Šï¼†æ£®æ—æµ´", time: "1æ™‚é–“", point: "éƒ½ä¼šã®ã‚ªã‚¢ã‚·ã‚¹ã§å¿ƒã‚’ãƒªã‚»ãƒƒãƒˆ", season: "é€šå¹´", people: "1äºº" },
            { location: "æ±äº¬", place: "ä»£ã€…æœ¨å…¬åœ’", activity: "ãƒ¬ã‚¸ãƒ£ãƒ¼ã‚·ãƒ¼ãƒˆåºƒã’ã¦ãƒ”ã‚¯ãƒ‹ãƒƒã‚¯", time: "åŠæ—¥", point: "é€±æœ«ã¯ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ¼ãŸã¡ã‚‚é›†çµ", season: "æ˜¥", people: "3-4äºº" },
            { location: "æ±äº¬", place: "ãŠå°å ´æµ·æµœå…¬åœ’", activity: "è‡ªç”±ã®å¥³ç¥å‰ã§è¨˜å¿µæ’®å½±", time: "2æ™‚é–“", point: "ãƒ¬ã‚¤ãƒ³ãƒœãƒ¼ãƒ–ãƒªãƒƒã‚¸ã®å¤œæ™¯ãŒæœ€é«˜", season: "é€šå¹´", people: "2äºº" },
            { location: "æ±äº¬", place: "å…­æœ¬æœ¨ãƒ’ãƒ«ã‚º", activity: "å±•æœ›å°ï¼†ã‚¢ãƒ¼ãƒˆé‘‘è³", time: "3æ™‚é–“", point: "æ£®ç¾è¡“é¤¨ã¯å¤œé…ãã¾ã§é–‹ã„ã¦ã‚‹", season: "é€šå¹´", people: "2äºº" },
            { location: "æ±äº¬", place: "æ¸‹è°·ã‚¹ã‚¯ãƒ©ãƒ³ãƒ–ãƒ«äº¤å·®ç‚¹", activity: "2éšã‚«ãƒ•ã‚§ã‹ã‚‰äººã®æµã‚Œã‚’çœºã‚ã‚‹", time: "1æ™‚é–“", point: "ä¸–ç•Œä¸€æœ‰åãªäº¤å·®ç‚¹ã‚’å ªèƒ½", season: "é€šå¹´", people: "2äºº" },
            { location: "æ±äº¬", place: "åŸå®¿ç«¹ä¸‹é€šã‚Š", activity: "ã‚¯ãƒ¬ãƒ¼ãƒ—é£Ÿã¹ãªãŒã‚‰ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°", time: "2æ™‚é–“", point: "SNSæ˜ ãˆã‚¹ã‚¤ãƒ¼ãƒ„ã®å®åº«", season: "é€šå¹´", people: "2äºº" },
            
            // æ±äº¬ - å…¬åœ’ãƒ»è‡ªç„¶
            { location: "æ±äº¬", place: "äº•ã®é ­æ©è³œå…¬åœ’", activity: "ãƒœãƒ¼ãƒˆæ¼•ããƒ‡ãƒ¼ãƒˆ", time: "2æ™‚é–“", point: "ã‚«ãƒƒãƒ—ãƒ«ã§ä¹—ã‚‹ã¨åˆ¥ã‚Œã‚‹ã‚¸ãƒ³ã‚¯ã‚¹ã¯æ°—ã«ã—ãªã„", season: "æ˜¥", people: "2äºº" },
            { location: "æ±äº¬", place: "æ–°å®¿å¾¡è‹‘", activity: "å››å­£æŠ˜ã€…ã®èŠ±ã‚’æ„›ã§ã‚‹æ•£ç­–", time: "2æ™‚é–“", point: "æ¡œã®å­£ç¯€ã¯æ··é›‘å¿…è‡³", season: "æ˜¥", people: "2äºº" },
            { location: "æ±äº¬", place: "ç §å…¬åœ’", activity: "ãƒãƒ‰ãƒŸãƒ³ãƒˆãƒ³ï¼†ãƒ”ã‚¯ãƒ‹ãƒƒã‚¯", time: "åŠæ—¥", point: "åºƒå¤§ãªèŠç”Ÿã§ã®ã‚“ã³ã‚Šéã”ã›ã‚‹", season: "æ˜¥", people: "3-4äºº" },
            { location: "æ±äº¬", place: "å°çŸ³å·å¾Œæ¥½åœ’", activity: "æ—¥æœ¬åº­åœ’ã§ã¾ã£ãŸã‚Šæ•£ç­–", time: "1æ™‚é–“", point: "å››å­£ã®ç§»ã‚ã„ã‚’æ„Ÿã˜ã‚‹åº­åœ’ç¾", season: "ç§‹", people: "2äºº" },
            { location: "æ±äº¬", place: "éš…ç”°å…¬åœ’", activity: "å·æ²¿ã„ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ï¼†ã‚¹ãƒˆãƒ¬ãƒƒãƒ", time: "1æ™‚é–“", point: "ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼ã‚’çœºã‚ãªãŒã‚‰é‹å‹•", season: "é€šå¹´", people: "1äºº" },
            
            // æ±äº¬ - ã‚«ãƒ•ã‚§ãƒ»é£²é£Ÿ
            { location: "æ±äº¬", place: "ç¥æ¥½å‚", activity: "çŸ³ç•³ã®è·¯åœ°è£ã‚«ãƒ•ã‚§å·¡ã‚Š", time: "3æ™‚é–“", point: "ãƒ•ãƒ©ãƒ³ã‚¹ã¨æ—¥æœ¬ãŒèåˆã—ãŸè¡—", season: "é€šå¹´", people: "2äºº" },
            { location: "æ±äº¬", place: "å‰ç¥¥å¯º", activity: "å€‹æ€§æ´¾ã‚«ãƒ•ã‚§ã§ã¾ã£ãŸã‚Šèª­æ›¸", time: "2æ™‚é–“", point: "ä½ã¿ãŸã„è¡—ãƒ©ãƒ³ã‚­ãƒ³ã‚°å¸¸é€£", season: "é€šå¹´", people: "1äºº" },
            { location: "æ±äº¬", place: "ä¸‹åŒ—æ²¢", activity: "å¤ç€å±‹å·¡ã‚Šï¼†ã‚«ãƒ¬ãƒ¼å±‹ãƒ©ãƒ³ãƒ", time: "3æ™‚é–“", point: "ã‚µãƒ–ã‚«ãƒ«å¥½ãã®è–åœ°", season: "é€šå¹´", people: "2äºº" },
            { location: "æ±äº¬", place: "æ¸…æ¾„ç™½æ²³", activity: "ã‚µãƒ¼ãƒ‰ã‚¦ã‚§ãƒ¼ãƒ–ã‚³ãƒ¼ãƒ’ãƒ¼é£²ã¿æ¯”ã¹", time: "2æ™‚é–“", point: "ãƒ–ãƒ«ãƒ¼ãƒœãƒˆãƒ«ã‚³ãƒ¼ãƒ’ãƒ¼ç™ºç¥¥ã®åœ°", season: "é€šå¹´", people: "2äºº" },
            { location: "æ±äº¬", place: "ä¸­ç›®é»’", activity: "ç›®é»’å·æ²¿ã„ã®ã‚«ãƒ•ã‚§ã§ãƒ–ãƒ©ãƒ³ãƒ", time: "2æ™‚é–“", point: "æ¡œã®å­£ç¯€ã¯çµ¶æ™¯ã‚¹ãƒãƒƒãƒˆ", season: "æ˜¥", people: "2äºº" },
            
            // ç¥å¥ˆå·
            { location: "ç¥å¥ˆå·", place: "æ¨ªæµœä¸­è¯è¡—", activity: "é£Ÿã¹æ”¾é¡Œï¼†å ã„å·¡ã‚Š", time: "3æ™‚é–“", point: "ä¸­å›½èŒ¶ã¨å ã„ã§é‹å‹¢ãƒã‚§ãƒƒã‚¯", season: "é€šå¹´", people: "3-4äºº" },
            { location: "ç¥å¥ˆå·", place: "ã¿ãªã¨ã¿ã‚‰ã„", activity: "è¦³è¦§è»Šï¼†å¤œæ™¯ãƒ‡ãƒ¼ãƒˆ", time: "2æ™‚é–“", point: "ã‚³ã‚¹ãƒ¢ãƒ¯ãƒ¼ãƒ«ãƒ‰ã¯å…¥åœ’ç„¡æ–™", season: "é€šå¹´", people: "2äºº" },
            { location: "ç¥å¥ˆå·", place: "æ±Ÿã®å³¶", activity: "æ±Ÿã®å³¶ã‚¨ã‚¹ã‚«ãƒ¼ï¼†å±•æœ›å°", time: "3æ™‚é–“", point: "ã—ã‚‰ã™ä¸¼ã¯å¿…é£Ÿ", season: "é€šå¹´", people: "2äºº" },
            { location: "ç¥å¥ˆå·", place: "éŒå€‰å¤§ä»", activity: "éŒå€‰å¤§ä»ã¨è¨˜å¿µæ’®å½±", time: "1æ™‚é–“", point: "å¤§ä»æ§˜ã®èƒå†…æ‹è¦³ã‚‚ã§ãã‚‹", season: "é€šå¹´", people: "2äºº" },
            { location: "ç¥å¥ˆå·", place: "ç®±æ ¹ãƒ­ãƒ¼ãƒ—ã‚¦ã‚§ã‚¤", activity: "ç©ºä¸­æ•£æ­©ï¼†å¤§æ¶Œè°·è¦‹å­¦", time: "3æ™‚é–“", point: "é»’ãŸã¾ã”ã§å¯¿å‘½7å¹´å»¶ã³ã‚‹", season: "é€šå¹´", people: "2äºº" },
            
            // åŸ¼ç‰
            { location: "åŸ¼ç‰", place: "å·è¶Š", activity: "å°æ±Ÿæˆ¸æ•£ç­–ï¼†èŠ‹ã‚¹ã‚¤ãƒ¼ãƒ„", time: "åŠæ—¥", point: "æ™‚ã®é˜ã¯å¿…è¦‹", season: "é€šå¹´", people: "2äºº" },
            { location: "åŸ¼ç‰", place: "é‰„é“åšç‰©é¤¨", activity: "é›»è»Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ä½“é¨“", time: "3æ™‚é–“", point: "é‰„é“ãƒ•ã‚¡ãƒ³ã®è–åœ°", season: "é€šå¹´", people: "2äºº" },
            { location: "åŸ¼ç‰", place: "ç§©çˆ¶", activity: "é•·ç€ãƒ©ã‚¤ãƒ³ä¸‹ã‚Šï¼†å²©ç•³æ•£ç­–", time: "åŠæ—¥", point: "æ–°ç·‘ã¨ç´…è‘‰ã®æ™‚æœŸãŒçµ¶æ™¯", season: "ç§‹", people: "3-4äºº" },
            { location: "åŸ¼ç‰", place: "æ‰€æ²¢ã‚µã‚¯ãƒ©ã‚¿ã‚¦ãƒ³", activity: "è§’å·æ­¦è”µé‡ãƒŸãƒ¥ãƒ¼ã‚¸ã‚¢ãƒ è¦‹å­¦", time: "2æ™‚é–“", point: "å·¨å¤§ãªæœ¬æ£šãŒåœ§å·»", season: "é€šå¹´", people: "2äºº" },
            { location: "åŸ¼ç‰", place: "å¤§å®®æ°·å·ç¥ç¤¾", activity: "å‚æ‹ï¼†æ°·å·ã ã‚“ã”", time: "1æ™‚é–“", point: "ç¸çµã³ã®ã”åˆ©ç›Š", season: "é€šå¹´", people: "2äºº" },
            
            // åƒè‘‰
            { location: "åƒè‘‰", place: "æ±äº¬ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼ãƒ©ãƒ³ãƒ‰", activity: "ã‚¢ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³åˆ¶è¦‡", time: "1æ—¥", point: "å¤¢ã®å›½ã§ç«¥å¿ƒã«å¸°ã‚‹", season: "é€šå¹´", people: "3-4äºº" },
            { location: "åƒè‘‰", place: "æˆç”°å±±æ–°å‹å¯º", activity: "å‚æ‹ï¼†å‚é“æ•£ç­–", time: "2æ™‚é–“", point: "ã†ãªãã‚‚å¿˜ã‚Œãšã«", season: "é€šå¹´", people: "2äºº" },
            { location: "åƒè‘‰", place: "é´¨å·ã‚·ãƒ¼ãƒ¯ãƒ¼ãƒ«ãƒ‰", activity: "ã‚·ãƒ£ãƒã‚·ãƒ§ãƒ¼é‘‘è³", time: "3æ™‚é–“", point: "æ°´ã—ã¶ãã§æ¿¡ã‚Œã‚‹è¦šæ‚Ÿã‚’", season: "é€šå¹´", people: "3-4äºº" },
            { location: "åƒè‘‰", place: "ãƒã‚¶ãƒ¼ç‰§å ´", activity: "å‹•ç‰©ã¨è§¦ã‚Œåˆã„ï¼†ã‚¸ãƒ³ã‚®ã‚¹ã‚«ãƒ³", time: "åŠæ—¥", point: "ç¾Šã®ã‚·ãƒ§ãƒ¼ãŒå¯æ„›ã„", season: "æ˜¥", people: "3-4äºº" },
            { location: "åƒè‘‰", place: "å¹•å¼µæµ·æµœå…¬åœ’", activity: "åºƒå¤§ãªèŠç”Ÿã§ãƒ•ãƒªã‚¹ãƒ“ãƒ¼", time: "2æ™‚é–“", point: "BBQæ–½è¨­ã‚‚å……å®Ÿ", season: "æ˜¥", people: "3-4äºº" },
            
            // ãµã–ã‘ãŸæ 
            { location: "æ±äº¬", place: "æ¸‹è°·é§…å‘¨è¾º", activity: "ãƒãƒå…¬åƒã®å‰ã§å¾…ã¡åˆã‚ã›ã”ã£ã“", time: "30åˆ†ä»¥å†…", point: "èª°ã‚‚æ¥ãªã„ã®ã«å¾…ã¡ç¶šã‘ã‚‹æ¼”æŠ€åŠ›", season: "é€šå¹´", people: "1äºº" },
            { location: "æ±äº¬", place: "ç§‹è‘‰åŸé§…", activity: "ã‚¬ãƒãƒ£ã‚¬ãƒãƒ£ã‚’10é€£ãƒãƒ£ãƒ¬ãƒ³ã‚¸", time: "30åˆ†ä»¥å†…", point: "æ¬²ã—ã„ã‚‚ã®ãŒå‡ºã‚‹ã¾ã§å›ã›", season: "é€šå¹´", people: "1äºº" },
            { location: "æ±äº¬", place: "éŠ€åº§ã®æ­©é“", activity: "ç™½ç·šã®ä¸Šã ã‘ã‚’æ­©ã„ã¦æ¨ªæ–­ã™ã‚‹", time: "30åˆ†ä»¥å†…", point: "å¤§äººã®å¹³å‡å°ãƒãƒ£ãƒ¬ãƒ³ã‚¸", season: "é€šå¹´", people: "1äºº" },
            { location: "ç¥å¥ˆå·", place: "å±±ä¸‹å…¬åœ’", activity: "æµ·ã‚’çœºã‚ãªãŒã‚‰ãƒ™ãƒ³ãƒã§æ˜¼å¯", time: "1æ™‚é–“", point: "æ½®é¢¨ãŒå¿ƒåœ°ã‚ˆã„æœ€é«˜ã®æ˜¼å¯ã‚¹ãƒãƒƒãƒˆ", season: "æ˜¥", people: "1äºº" },
            { location: "åŸ¼ç‰", place: "ç§©çˆ¶é§…", activity: "é§…ã®ãƒ™ãƒ³ãƒã§æ¬¡ã®é›»è»Šã¾ã§æ˜¼å¯", time: "1æ™‚é–“", point: "ãƒ­ãƒ¼ã‚«ãƒ«ç·šã®é†é†å‘³", season: "é€šå¹´", people: "1äºº" },
            { location: "åƒè‘‰", place: "å¸‚å·å¸‚", activity: "æ±Ÿæˆ¸å·ã®åœŸæ‰‹ã§å¯è»¢ãŒã‚‹", time: "1æ™‚é–“", point: "ä½•ã‚‚ã—ãªã„è´…æ²¢æ™‚é–“", season: "æ˜¥", people: "1äºº" }
        ];

        // DOMè¦ç´ 
        const decideBtn = document.getElementById('decide-btn');
        const mainCard = document.getElementById('main-card');
        const resetBtn = document.getElementById('reset-btn');
        const shareBtn = document.getElementById('share-btn');
        const closeBtn = document.getElementById('close-btn');
        const starLayer = document.getElementById('star-layer');
        const liffLoading = document.getElementById('liff-loading');
        const userGreeting = document.getElementById('user-greeting');

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¦ç´ 
        const timeFilter = document.getElementById('time-filter');
        const peopleFilter = document.getElementById('people-filter');
        const locationFilter = document.getElementById('location-filter');
        const seasonFilter = document.getElementById('season-filter');

        // çµæœè¡¨ç¤ºè¦ç´ 
        const resultTitle = document.getElementById('result-title');
        const resultLocation = document.getElementById('result-location');
        const resultActivity = document.getElementById('result-activity');
        const resultPoint = document.getElementById('result-point');
        const resultTags = document.getElementById('result-tags');

        // ç¾åœ¨ã®çµæœã‚’ä¿å­˜
        let currentResult = null;

        // ========================================
        // LIFFåˆæœŸåŒ–
        // ========================================
        async function initializeLiff() {
            try {
                await liff.init({ liffId: LIFF_ID });
                
                // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°éè¡¨ç¤º
                liffLoading.classList.add('hidden');

                // ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ç¢ºèª
                if (!liff.isLoggedIn()) {
                    liff.login();
                    return;
                }

                // é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºï¼ˆLIFFãƒ–ãƒ©ã‚¦ã‚¶å†…ã®å ´åˆã®ã¿ï¼‰
                if (!liff.isInClient()) {
                    closeBtn.style.display = 'flex';
                }

                // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—
                const profile = await liff.getProfile();
                userGreeting.textContent = `${profile.displayName}ã•ã‚“ã€ã“ã‚“ã«ã¡ã¯ï¼`;
                userGreeting.style.display = 'block';

                // ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
                shareBtn.style.display = 'block';

            } catch (error) {
                console.error('LIFFåˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
                alert('LINEã‚¢ãƒ—ãƒªã¨ã®é€£æºã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
                liffLoading.classList.add('hidden');
            }
        }

        // é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³
        closeBtn.addEventListener('click', () => {
            liff.closeWindow();
        });

        // ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³
        shareBtn.addEventListener('click', () => {
            if (!currentResult) return;

            const shareMessage = {
                type: 'text',
                text: `ğŸ´ ä»Šæ—¥ã®ãŠã™ã™ã‚ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ ğŸ´\n\nğŸ“ ${currentResult.place}ï¼ˆ${currentResult.location}ï¼‰\nâœ¨ ${currentResult.activity}\n\nğŸ’¡ ${currentResult.point}\n\nâ±ï¸ ${currentResult.time} | ğŸ‘¥ ${currentResult.people} | ğŸŒ¸ ${currentResult.season}\n\nã‚ãªãŸã‚‚é‹å‘½ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’è¦‹ã¤ã‘ã‚ˆã†ï¼`
            };

            if (liff.isApiAvailable('shareTargetPicker')) {
                liff.shareTargetPicker([shareMessage])
                    .then(() => {
                        console.log('ã‚·ã‚§ã‚¢æˆåŠŸ');
                    })
                    .catch((error) => {
                        console.error('ã‚·ã‚§ã‚¢ã‚¨ãƒ©ãƒ¼:', error);
                        alert('ã‚·ã‚§ã‚¢ã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
                    });
            } else {
                alert('ã“ã®ç’°å¢ƒã§ã¯ã‚·ã‚§ã‚¢æ©Ÿèƒ½ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“ã€‚');
            }
        });

        // ========================================
        // ã‚¢ãƒ—ãƒªã®åˆæœŸåŒ–å‡¦ç†
        // ========================================
        function createStars() {
            // ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ–ï¼šæ˜Ÿã®æ•°ã‚’50ã«å‰Šæ¸›
            for (let i = 0; i < 50; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                star.style.animationDuration = (Math.random() * 2 + 2) + 's';
                starLayer.appendChild(star);
            }
        }

        // æµã‚Œæ˜Ÿç”Ÿæˆ
        function createShootingStar() {
            const shootingStar = document.createElement('div');
            shootingStar.className = 'shooting-star';
            shootingStar.style.left = Math.random() * 50 + '%';
            shootingStar.style.top = Math.random() * 50 + '%';
            document.body.appendChild(shootingStar);
            
            setTimeout(() => shootingStar.remove(), 2000);
        }

        // å®šæœŸçš„ã«æµã‚Œæ˜Ÿã‚’ç”Ÿæˆï¼ˆãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ–ï¼š5ç§’ã«å¤‰æ›´ï¼‰
        setInterval(createShootingStar, 5000);

        // æ±ºã‚ã‚‹ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯
        decideBtn.addEventListener('click', () => {
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å€¤å–å¾—
            const filters = {
                time: timeFilter.value,
                people: peopleFilter.value,
                location: locationFilter.value,
                season: seasonFilter.value
            };

            // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆå…¨æ¡ä»¶ï¼‰
            let filtered = activities.filter(activity => {
                if (filters.time && activity.time !== filters.time) return false;
                if (filters.people && activity.people !== filters.people) return false;
                if (filters.location && activity.location !== filters.location) return false;
                if (filters.season && activity.season !== filters.season && activity.season !== 'é€šå¹´') return false;
                return true;
            });

            // è©²å½“ãªã—ã®å ´åˆã®æ®µéšçš„ç·©å’Œ
            if (filtered.length === 0) {
                if (filters.location) {
                    filtered = activities.filter(activity => activity.location === filters.location);
                }
                if (filtered.length === 0) {
                    filtered = activities;
                }
            }

            // ãƒ©ãƒ³ãƒ€ãƒ é¸æŠ
            const randomActivity = filtered[Math.floor(Math.random() * filtered.length)];

            // ãƒœã‚¿ãƒ³ã‚’ä¸€æ™‚çš„ã«ç„¡åŠ¹åŒ–
            decideBtn.disabled = true;
            decideBtn.innerHTML = '<div class="loading"></div>';

            // çµæœã‚’è¨­å®š
            displayResult(randomActivity);

            // æ¼”å‡ºé–‹å§‹
            setTimeout(() => {
                mainCard.classList.add('drawing');
                createExplosion();

                for (let i = 0; i < 3; i++) {
                    setTimeout(createShootingStar, i * 200);
                }

                // ã‚«ãƒ¼ãƒ‰ã‚’ã‚ãã‚‹
                setTimeout(() => {
                    mainCard.classList.remove('drawing');
                    mainCard.classList.add('flipped');
                    decideBtn.disabled = false;
                    decideBtn.innerHTML = 'æ±ºã‚ã‚‹ï¼';
                    
                    createVictoryParticles();
                }, 1000);
            }, 100);
        });

        // çˆ†ç™ºçš„ãªãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ç”Ÿæˆï¼ˆãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ–ï¼š15å€‹ã«å‰Šæ¸›ï¼‰
        function createExplosion() {
            const colors = ['#FF006E', '#00F5FF', '#8B00FF', '#FFD700', '#FF4500'];
            for (let i = 0; i < 15; i++) {
                const particle = document.createElement('div');
                particle.className = 'neon-particle';
                particle.style.left = '50%';
                particle.style.top = '50%';
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                particle.style.boxShadow = `0 0 15px ${colors[Math.floor(Math.random() * colors.length)]}`;
                
                const angle = (Math.PI * 2 * i) / 15;
                const velocity = Math.random() * 80 + 40;
                const tx = Math.cos(angle) * velocity;
                const ty = Math.sin(angle) * velocity;
                
                particle.style.transform = `translate(${tx}px, ${ty}px)`;
                
                document.body.appendChild(particle);
                
                setTimeout(() => particle.remove(), 3000);
            }
        }

        // å‹åˆ©ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ç”Ÿæˆï¼ˆãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ–ï¼š20å€‹ã«å‰Šæ¸›ï¼‰
        function createVictoryParticles() {
            const colors = ['#FF006E', '#00F5FF', '#FFD700'];
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'neon-particle';
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.bottom = '0';
                    particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                    particle.style.boxShadow = `0 0 15px ${colors[Math.floor(Math.random() * colors.length)]}`;
                    particle.style.animationDuration = (Math.random() * 2 + 2) + 's';
                    document.body.appendChild(particle);
                    
                    setTimeout(() => particle.remove(), 4000);
                }, i * 60);
            }
        }

        // ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯
        resetBtn.addEventListener('click', () => {
            mainCard.classList.remove('flipped');
            createShootingStar();
        });

        // çµæœè¡¨ç¤ºé–¢æ•°
        function displayResult(activity) {
            currentResult = activity; // çµæœã‚’ä¿å­˜
            
            resultTitle.textContent = activity.place;
            resultLocation.innerHTML = `ğŸ“ ${activity.location}`;
            resultActivity.textContent = activity.activity;
            resultPoint.textContent = activity.point;

            // ã‚¿ã‚°ç”Ÿæˆ
            resultTags.innerHTML = `
                <span class="tag">â±ï¸ ${activity.time}</span>
                <span class="tag">ğŸ‘¥ ${activity.people}</span>
                <span class="tag">ğŸŒ¸ ${activity.season}</span>
            `;
        }

        // ========================================
        // åˆæœŸåŒ–å‡¦ç†
        // ========================================
        // LIFFåˆæœŸåŒ–
        initializeLiff();
        
        // æ˜Ÿç©ºç”Ÿæˆ
        createStars();
    </script>
</body>
</html>
